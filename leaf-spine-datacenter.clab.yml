name: leaf-spine-datacenter

topology:
  nodes:
    Spine-1:
      kind: linux
      image: frrouting/frr:latest
      labels:
        layer: "spine"
      exec:
        - ip link set eth1 up
        - ip link set eth2 up
        - ip link set eth3 up

    Spine-2:
      kind: linux
      image: frrouting/frr:latest
      labels:
        layer: "spine"
      exec:
        - ip link set eth1 up
        - ip link set eth2 up
        - ip link set eth3 up

    Leaf-1:
      kind: linux
      image: frrouting/frr:latest
      labels:
        layer: "leaf"
      exec:
        - ip link set eth1 up
        - ip link set eth2 up
        - ip link set eth3 up
        - ip link set eth4 up

    Leaf-2:
      kind: linux
      image: frrouting/frr:latest
      labels:
        layer: "leaf"
      exec:
        - ip link set eth1 up
        - ip link set eth2 up
        - ip link set eth3 up

    Edge-Router:
      kind: linux
      image: frrouting/frr:latest
      labels:
        layer: "edge"
      exec:
        - ip link set eth1 up
        - ip link set eth2 up
        - ip link set eth3 up

    Server-1:
      kind: linux
      image: alpine:latest
      labels:
        vlan: "10"
      exec:
        - ip link set eth1 up

    Server-2:
      kind: linux
      image: alpine:latest
      labels:
        vlan: "20"
      exec:
        - ip link set eth1 up

    Client-1:
      kind: linux
      image: alpine:latest
      labels:
        vlan: "30"
      exec:
        - ip link set eth1 up

    Internet:
      kind: linux
      image: alpine:latest
      labels:
        role: "external"
      exec:
        - ip link set eth1 up

  links:
    - endpoints: ["Spine-1:eth1", "Leaf-1:eth1"]
    - endpoints: ["Spine-1:eth2", "Leaf-2:eth1"]
    - endpoints: ["Spine-2:eth1", "Leaf-1:eth2"]
    - endpoints: ["Spine-2:eth2", "Leaf-2:eth2"]
    - endpoints: ["Spine-1:eth3", "Edge-Router:eth1"]
    - endpoints: ["Spine-2:eth3", "Edge-Router:eth2"]
    - endpoints: ["Leaf-1:eth3", "Server-1:eth1"]
    - endpoints: ["Leaf-1:eth4", "Server-2:eth1"]
    - endpoints: ["Leaf-2:eth3", "Client-1:eth1"]
    - endpoints: ["Edge-Router:eth3", "Internet:eth1"]
